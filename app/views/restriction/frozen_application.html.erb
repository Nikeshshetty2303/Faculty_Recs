
<%= stylesheet_link_tag 'myresponses' %>

<div class="container mt-4">
  <div class="text-center">
    <h1 class="fw-bold mb-2">Your Frozen Application</h1>

  </div>
  <%= button_to 'Log Out', destroy_user_session_path,  method: :delete,  class: "btn btn-outline-danger"%>

  <div class="responses">
    <% @responses.where(profile_response: nil, status: "Freezed").each do |response| %>
      <div class="card mb-4">
        <div class="card-body">
          <% present_response_id = response.id %>
          <% below_responses = Response.where(profile_response: true).where("id < ?", present_response_id) %>
          <% count_below_responses = below_responses.count %>
          <% role = response.form.role %>
          <% dept = response.form.department.title %>

          <%if response.app_no.present?%>
            <h5 class="card-title"><%=response.app_no%></h5>
          <%else%>
            <h5 class="card-title"><%= "#{role}#{dept}#{1000 + response.id - count_below_responses}" %></h5>
          <%end%>


    <div class="d-flex justify-content-between align-items-center mt-3">
      <p class="mb-0">
        <strong>Credits Obtained:</strong> <%= response.credit_score %>
      </p>
      </div>

          <div class="btn-group btn-group-responsive" role="group" aria-label="Response actions">
            <%if response.status == "Freezed"%>
              <%= link_to "Download Frozen Application", view_app_pdf_response_path(id: response.id, userid: @user.id), class: 'btn btn-outline-success btn-sm' %>
              <%= link_to "Download Finalized Uploads", view_combined_pdf_response_path(id: response.id, userid: response.user.id), class: 'btn btn-outline-info btn-sm', target: "_blank" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl)
    })
  });
</script>
