<div class="container-sm p-2">
    <div class="text-center">
        <%= link_to "Back to My Response", myresponse_response_path(id: @user.id), class:"btn btn-info mt-3" %>
    </div>

    <h1 class="text-center fw-bold mt-3">View Form Response</h1>

    <div class="response-container p-4" style="background-color: rgba(127, 172, 218, 0.16); border-radius: 6px;">
        <div class="alert alert-success" role="alert">
            This is the response for the form:
        </div>

        <% @response.answers.sort_by { |answer| answer.question_id }.each do |answer| %>
            <% if answer.question.question_type_id == 6 %>
                <div class="mb-3">
                    <label class="form-label"><%= answer.question.title %></label>
                    <table class="table">
                        <thead>
                            <tr>
                                <% answer.question.options.each do |option| %>
                                    <th><%= option.title %></th>
                                <% end %>
                            </tr>
                        </thead>
                        <tbody>
                            <% content = eval(answer.content) %>
                            <% content.each_slice(answer.question.options.size) do |chunk| %>
                                <tr>
                                    <% chunk.each do |element| %>
                                        <td><%= element.gsub(/[\[\]\"]/,"") %></td>
                                    <% end %>
                                </tr>
                            <% end %>
                        </tbody>
                    </table>
                </div>
            <% else %>
                <div class="mb-3">
                    <label class="form-label"><%= answer.question.title %></label>
                    <% content = answer.content.gsub(/[\[\]\"]/,"").split(", ").first %>
                    <input readonly class="form-control" value="<%= content %>">
                </div>
            <% end %>
        <% end %>
    </div>
</div>
